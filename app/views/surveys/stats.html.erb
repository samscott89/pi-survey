<%= provide(:title, @survey.name) %>

<div class="center">

<h1><%= @survey.name %></h1>
	

<div class="table-responsive">
  <table class="table table-hover">
    <thead>
    <tr>
    	<th>User</th>
    	<% @questions.each_with_index do |q, idx| %>
			<th>
			<!-- Link to modal -->
			<%= link_to "Q#{idx+1}.", "#", "data-toggle" => "modal", "data-target" => "#myModal#{q.id}" %>
			<%= render partial: "questions/display", locals: {q: q} %>
			</th>
    	<% end %>
    </tr
    </thead>
    <tbody>
    	<% @users.each do |u| %>
    	<tr>
    		<th> <%= u.id %> </th>
    		<% @questions.each do |q| %>
    		<% text =  (@answers[u.id][q.id].answer_options.pluck(:answer_text) << @answers[u.id][q.id].answer_text).join(" ") unless @answers[u.id][q.id].nil? %>
    			<% if q.question_type.id == @ta_type  %>
    				<td><%= link_to "View", "#", tabindex: 0, role: "button", "data-toggle"=>"popover", "data-placement"=>"right",title: "Question answer", "data-content"=>text %></td>
    			<% else %>
    			<td><%= text %></td>
    			<% end %>
    		<% end %>
    	</tr>
    	<% end %>

    		

    </tbody>
  </table>
  

<%= link_to "Export as CSV",  survey_stats_path(@survey, format: :csv), class: "btn btn-large btn-success"%>

</div>